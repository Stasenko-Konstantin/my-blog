<!DOCTYPE html>
<html lang="ru">

    <head><title>Сборка go-приложений на fyne под Android &ndash; Stasenko-Konstantin</title>


<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="UTF-8"/>



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<link rel="stylesheet" href="https://Stasenko-Konstantin/blog/css/palettes/base16-dark.css">
<link rel="stylesheet" href="https://Stasenko-Konstantin/blog/css/risotto.css">
<link rel="stylesheet" href="https://Stasenko-Konstantin/blog/css/custom.css">










</head>

    <body>
        <div class="page">

            <header class="page__header"><nav class="page__nav main-nav">
    <ul>
      <li class="nomarker"><h1 class="page__logo"><a href="https://Stasenko-Konstantin/blog/" class="page__logo-inner">Stasenko-Konstantin</a></h1></li>
    
    
    </ul>
</nav>

</header>

            <section class="page__body">
    <header class="content__header">
        <h1>Сборка go-приложений на fyne под Android</h1>
    </header>
    <div class="content__body">
        <hr>
<h2 id="содержание">Содержание:</h2>
<ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-android-sdk--ndk">Установка Android Sdk &amp; Ndk</a></li>
<li><a href="#%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-go-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">Создание go-приложения</a></li>
<li><a href="#%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%B8%D0%BC-%D1%82%D0%B5%D0%BB%D0%B5%D1%84%D0%BE%D0%BD-%D0%BA-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B5">Готовим телефон к работе</a></li>
<li><a href="#%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F-%D0%BD%D0%B0-%D1%82%D0%B5%D0%BB%D0%B5%D1%84%D0%BE%D0%BD%D0%B5">Запуск приложения на телефоне</a></li>
<li><a href="#makefile-%D0%B4%D0%BB%D1%8F-%D1%83%D0%B4%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B0-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B">Makefile для удобства работы</a></li>
</ul>
<hr>
<h2 id="prerequisites">Prerequisites:</h2>
<p>Сперва установим всё необходимое:</p>
<ul>
<li><a href="https://go.dev/dl/">go</a></li>
<li><a href="https://docs.fyne.io/">fyne</a>, а также <code>go install fyne.io/fyne/v2/cmd/fyne@latest</code></li>
<li>на случай если вы сейчас на <code>Windows</code>, то нужен еще и <a href="http://www.equation.com/servlet/equation.cmd?fa=fortran">gcc for windows</a>. Он понадобиться и для обычной компиляции под сам <code>Windows</code>. Не забудьте добавить путь к нему в <code>PATH</code>.</li>
</ul>
<hr>
<h2 id="установка-android-sdk--ndk">Установка Android Sdk &amp; Ndk:</h2>
<p>Отдельно поговорим про установку Android <code>Sdk</code> и <code>Ndk</code>.
Сперва создадим место под них в <code>~</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir Android
</span></span></code></pre></div><p>Затем по <a href="https://github.com/android/ndk/wiki/Unsupported-Downloads">этой ссылке</a> скачиваем <code>Ndk</code> версии <code>r24</code> под нужную вам ОС. Распаковываем <code>Ndk</code> в нашу директорию <code>Android</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install unzip
</span></span><span style="display:flex;"><span>cd Загрузки
</span></span><span style="display:flex;"><span>unzip anroid-ndk-r24-linux.zip -d ~/Android
</span></span><span style="display:flex;"><span>cd ~/Anrdoid
</span></span><span style="display:flex;"><span>mv ndk-r24-linux ndk-bundle
</span></span></code></pre></div><p>Чтобы установить <code>Sdk</code> переходим по <a href="https://developer.android.com/tools/releases/platform-tools?hl=ru">этой ссылке</a> и выбираем нужную ОС. Нужно будет согласится с условиями пользования. Теперь устанавливаем:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd Загрузки
</span></span><span style="display:flex;"><span>unzip platform-tools-latest-linux.zip -d ~/Android
</span></span><span style="display:flex;"><span>cd ~/Android
</span></span><span style="display:flex;"><span>mv platform-tools Sdk
</span></span></code></pre></div><p>Мы установили всё необходимое, теперь нужно настроить переменные окружения. Вот как это можно сделать в <code>Linux</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>emacs ~/.bashrc
</span></span></code></pre></div><p>Вместо <code>emacs</code> можете использовать свой любимый редактор (но я буду вас осуждать за это). И добавляем в конец файла следующий фрагмент в котором заменяем все вхождения {$user} на свое имя пользователя:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export ANDROID_HOME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/home/{</span>$user<span style="color:#e6db74">}/Android&#34;</span>
</span></span><span style="display:flex;"><span>export ANDROID_NDK_HOME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/home/{</span>$user<span style="color:#e6db74">}/Android/ndk-bundle&#34;</span>
</span></span><span style="display:flex;"><span>export ANDROID_SDK_HOME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/home/{</span>$user<span style="color:#e6db74">}/Android/Sdk&#34;</span>
</span></span><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span>$PATH:$ANDROID_HOME:$ANDROID_NDK_HOME:$ANDROID_SDK_HOME
</span></span></code></pre></div><p>Теперь проверим что мы всё сделали правильно:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>source ~/.bashrc
</span></span><span style="display:flex;"><span>which adb <span style="color:#75715e"># должно вывести: /home/{$user}/Android/Sdk/adb</span>
</span></span></code></pre></div><hr>
<h2 id="создание-go-приложения">Создание go-приложения:</h2>
<p>Теперь можно приступить к созданию самого приложения:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir my-app <span style="color:#f92672">&amp;&amp;</span> cd my-app
</span></span><span style="display:flex;"><span>emacs main.go
</span></span></code></pre></div><p>И добавляем следующий код:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fyne.io/fyne/v2/app&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fyne.io/fyne/v2/widget&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">a</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">NewWindow</span>(<span style="color:#e6db74">&#34;my-app&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">l</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">widget</span>.<span style="color:#a6e22e">NewLabel</span>(<span style="color:#e6db74">&#34;hello&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">SetContent</span>(<span style="color:#a6e22e">l</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">ShowAndRun</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Возвращаемся в терминал и проверяем что код работает:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go mod tidy
</span></span><span style="display:flex;"><span>go run main.go
</span></span></code></pre></div><hr>
<h2 id="готовим-телефон-к-работе">Готовим телефон к работе:</h2>
<p>Перво-наперво нужно настроить устройство на котором будет запускаться приложение. Есть несколько разных вариантов, но я остановлюсь на работе через <code>USB</code>. Способы для разных версий <code>Android</code> могут отличаться, в моем случае нужно было сделать следующее: заходим в настройках в <code>О телефоне</code>, много раз нажимаем на <code>Версия MIUI</code> пока не появится сообщение о получении прав разработчика, далее переходим в <code>Расширенные настройки/Для разработчиков</code> где включаем <code>Режим разработчика</code>, после чего ищем раздел <code>Отладка</code> и включаем опцию <code>Отладка по USB</code>. Когда устройство будет подготовлено подключаем его по <code>USB</code> кабелю к вашей машине.</p>
<hr>
<h2 id="запуск-приложения-на-телефоне">Запуск приложения на телефоне:</h2>
<p>Прежде чем запустить ваше приложение на телефоне необходимо сделать иконку этого приложения. Оно должно быть разрешением <code>100х100</code> пикселей и в формате <code>png</code>. Я обычно называю его <code>logo.png</code>.</p>
<p>Теперь у нас есть всё необходимое для запуска. Введите в терминале в корне вашего проекта следующее:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go mod tidy
</span></span><span style="display:flex;"><span>fyne package -os android -appID my.app -icon logo.png -name myapp
</span></span><span style="display:flex;"><span>adb -d install -r myapp.apk
</span></span></code></pre></div><p>Возможно для пользования <code>adb</code> придется еще немного повозиться, но я сейчас не могу точно сказать что именно нужно будет сделать. Как это принято говорить: оставим читателю в качестве упражнения)</p>
<hr>
<h2 id="makefile-для-удобства-работы">Makefile для удобства работы:</h2>
<p>Создадим следующий <code>Makefile</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-make" data-lang="make"><span style="display:flex;"><span><span style="color:#a6e22e">build</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	go mod tidy
</span></span><span style="display:flex;"><span>	fyne package -os android -appID my.app -icon logo.png -name myapp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">debug</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	adb -d install -r myapp.apk
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">install</span><span style="color:#f92672">:</span> build debug
</span></span></code></pre></div><p>Теперь после внесения изменений в код приложения всё что нужно будет сделать для их проверки на телефоне это вызвать следующую команду:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make install
</span></span></code></pre></div><hr>
<p>Поздравляю! Теперь у вас есть свое Android-приложение написанное на <code>Go</code>!</p>
<hr>
<p><a href="#%D1%81%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5">наверх</a></p>

    </div>
    <footer class="content__footer"></footer>

            </section>

            <section class="page__aside">
                <div class="aside__about">

<ul class="aside__social-links">
    
</ul>
</div>
                <hr>
                <div class="aside__content">
    
    
        <p>
            
            2025-03-02
        </p>
    

    

                </div>
            </section>

            <footer class="page__footer"><p>
    
    
    
    
    
    
    
    
      
      
          
            
            
                <br/><span class="active">$ echo $LANG<br/><b></b></span><br/>

            
          
      
    
</p>
<br /><br />
<p class="copyright"></p>
<p class="advertisement">Powered by <a href="https://gohugo.io/">hugo</a> and <a href="https://github.com/joeroe/risotto">risotto</a>.</p>
</footer>

        </div>
    </body>

</html>
